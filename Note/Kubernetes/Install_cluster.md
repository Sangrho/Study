# 1. /etc/hosts 등록
$> vim /etc/hosts  </br>
10.231.219.205	k8s-maser </br>
10.231.219.206	node1 </br>
10.231.219.202	node2 </br>

# 2. Disable SELinux
$> sudo set enforce 0 </br>
$> sudo sed -i --follow-symlinks 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux </br>

# 3. Disable SWAP
$> sudo /sbin/swapoff -a

# 4. Comment swap line
$> sudo vim /etc/fstab
.
.
#/dev/vdb       none    swap    sw,comment=cloudconfig  0       0

# 5. Install Docker CE
$> sudo yum install -y yum-utils device-mapper-persistent-data lvm2 </br>
$> sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo </br>
$> sudo yum install -y docker-ce </br>

# 6. Install Kubernetes
$> sudo vim /etc/yum.repos.d/kubernetes.repo </br>
[kubernetes] </br>
name=Kubernetes </br>
baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64 </br>
enabled=1 </br>
gpgcheck=1 </br>
repo_gpgcheck=1 </br>
gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg </br>
        https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg </br>

$> sudo yum install -y kubelet kubeadm kubectl </br>
$> sudo reboot </br>
$> sudo systemctl start docker && sudo systemctl enable docker </br>
$> sudo systemctl start kubelet && sudo systemctl enable kubelet </br>

# 7. Initialize Kubernetes Cluster
$> kubeadm init --apiserver-advertise-address=10.231.219.205 --pod-network-cidr=10.231.219.0/16 </br>
$> mkdir -p $HOME/.kube </br>
$> sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config </br>
$> sudo chown $(id -u):$(id -g) $HOME/.kube/config </br>
$> kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml </br>

# 8. Add node01, node02
k8s-master $> kubeadm token list </br> </br>
TOKEN                     TTL       EXPIRES                     USAGES                   DESCRIPTION         </br>                                        EXTRA GROUPS </br> </br>
dnyv8x.7ilcfua1eabn78lw   22h       2019-08-30T10:06:41+09:00   authentication,signing   The default bootstrap token generated by 'kubeadm init'.   system:bootstrappers:kubeadm:default-node-token </br>
k8s-master $> openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2>/dev/null | openssl dgst -sha256 -hex | sed 's/^.* //' </br> </br>
665bdadfe347bab9412f24e1853ec160a0bd11f162ca128ea67de5995e5567f4 </br> </br>
node1 $> kubeadm join 10.231.219.205:6443 --token dnyv8x.7ilcfua1eabn78lw --discovery-token-ca-cert-hash sha256:665bdadfe347bab9412f24e1853ec160a0bd11f162ca128ea67de5995e5567f4 </br> </br>

node2 $> kubeadm join 10.231.219.205:6443 --token dnyv8x.7ilcfua1eabn78lw --discovery-token-ca-cert-hash sha256:665bdadfe347bab9412f24e1853ec160a0bd11f162ca128ea67de5995e5567f4 </br> </br>

k8s-master $> kubectl get nodes </br>
k8s-master $> kubectl get pods --all-namespaces </br>


Ref. https://www.howtoforge.com/tutorial/centos-kubernetes-docker-cluster/ </br>
