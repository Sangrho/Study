# 1. /etc/hosts 등록
$> vim /etc/hosts
10.231.219.205	k8s-maser
10.231.219.206	node1
10.231.219.202	node2

# 2. Disable SELinux
$> sudo set enforce 0
$> sudo sed -i --follow-symlinks 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux

# 3. Disable SWAP
$> sudo /sbin/swapoff -a

# 4. Comment swap line
$> sudo vim /etc/fstab
.
.
#/dev/vdb       none    swap    sw,comment=cloudconfig  0       0

# 5. Install Docker CE
$> sudo yum install -y yum-utils device-mapper-persistent-data lvm2
$> sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
$> sudo yum install -y docker-ce

# 6. Install Kubernetes
$> sudo vim /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg
        https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg

$> sudo yum install -y kubelet kubeadm kubectl
$> sudo reboot
$> sudo systemctl start docker && sudo systemctl enable docker
$> sudo systemctl start kubelet && sudo systemctl enable kubelet

# 7. Initialize Kubernetes Cluster
$> kubeadm init --apiserver-advertise-address=10.231.219.205 --pod-network-cidr=10.231.219.0/16
$> mkdir -p $HOME/.kube
$> sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
$> sudo chown $(id -u):$(id -g) $HOME/.kube/config
$> kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml

# 8. Add node01, node02
k8s-master $> kubeadm token list
TOKEN                     TTL       EXPIRES                     USAGES                   DESCRIPTION                                                EXTRA GROUPS
dnyv8x.7ilcfua1eabn78lw   22h       2019-08-30T10:06:41+09:00   authentication,signing   The default bootstrap token generated by 'kubeadm init'.   system:bootstrappers:kubeadm:default-node-token
k8s-master $> openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2>/dev/null | openssl dgst -sha256 -hex | sed 's/^.* //'
665bdadfe347bab9412f24e1853ec160a0bd11f162ca128ea67de5995e5567f4
node1 $> kubeadm join 10.231.219.205:6443 --token dnyv8x.7ilcfua1eabn78lw --discovery-token-ca-cert-hash sha256:665bdadfe347bab9412f24e1853ec160a0bd11f162ca128ea67de5995e5567f4

node2 $> kubeadm join 10.231.219.205:6443 --token dnyv8x.7ilcfua1eabn78lw --discovery-token-ca-cert-hash sha256:665bdadfe347bab9412f24e1853ec160a0bd11f162ca128ea67de5995e5567f4

k8s-master $> kubectl get nodes
k8s-master $> kubectl get pods --all-namespaces


Ref. https://www.howtoforge.com/tutorial/centos-kubernetes-docker-cluster/
